<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=390, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>KÖNIGIN - Filet-o-Fish</title>
  <link rel="stylesheet" href="/style/index.css">
  <link rel="stylesheet" href="/style/footer.css">
  <style>
    :root {
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
    }

    html, body {
      margin: 0; 
      padding: 0;
      width: 100vw;
      height: 100vh;
      background: #191919;
      overflow: hidden;
    }

    .app-frame {
      width: 100vw;
      height: 100vh;
      max-width: 100vw;
      max-height: 100vh;
      position: relative;
      margin: 0;
      border-radius: 0;
      overflow: hidden;
      box-shadow: none;
      background: #191919;
      padding-top: env(safe-area-inset-top, 0px);
      padding-bottom: env(safe-area-inset-bottom, 0px);
      top: 0; 
      left: 0; 
      right: 0; 
      bottom: 0;
      box-sizing: border-box;
    }

    /* 横向滑动背景容器 */
    .horizontal-bg-container {
      position: absolute;
      left: 0; 
      top: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: 1;
    }

    /* 背景图片容器 - 可以左右滑动 */
    .bg-slider {
      position: absolute;
      left: 0; 
      top: 0;
      width: 300%; /* 3倍宽度，对应图片的3个部分 */
      height: 100%;
      background-image: url('../../img/guest/filet-o-fish_bg.png');
      background-size: auto 100%; /* 保持图片比例，高度100% */
      background-position: left center;
      background-repeat: no-repeat;
      transition: transform 0.3s ease-out;
      cursor: grab;
    }

    .bg-slider:active {
      cursor: grabbing;
    }

    /* 滑动指示器 */
    .slide-indicators {
      position: absolute;
      bottom: 120px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 12px;
      z-index: 10;
    }

    .indicator {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .indicator.active {
      background: rgba(255, 255, 255, 0.8);
      transform: scale(1.2);
    }

    /* 滑动提示 */
    .slide-hint {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: rgba(255, 255, 255, 0.6);
      font-size: 14px;
      font-family: "SimSun", "宋体", serif;
      text-align: center;
      z-index: 5;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .slide-hint.show {
      opacity: 1;
    }

    /* 内容层 */
    .content-layer {
      position: absolute;
      left: 0; 
      top: 0;
      width: 100%;
      height: 100%;
      z-index: 2;
      pointer-events: none;
    }

    .content-layer > * {
      pointer-events: auto;
    }

    /* 标题 */
    .page-title {
      position: absolute;
      top: 5%;
      left: 50%;
      transform: translateX(-50%);
      width: 300px;
      height: 120px;
      z-index: 2;
      pointer-events: none;
    }

    /* 交互按钮 */
    .interaction-btn {
      position: absolute;
      z-index: 10;
      display: block;
      cursor: pointer;
    }

    .btn-center {
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .interaction-btn img {
      width: 8vw;
      height: 8vw;
      min-width: 60px;
      min-height: 60px;
      max-width: 100px;
      max-height: 100px;
      display: block;
      pointer-events: auto;
      transition: all 0.2s ease;
    }

    .interaction-btn:hover img {
      filter: brightness(1.2);
      transform: scale(1.05);
    }

    .interaction-btn:active img {
      filter: brightness(0.8);
      transform: scale(0.95);
    }

    /* 底部遮罩 */
    .bottom-mask {
      position: absolute;
      left: 0; 
      bottom: 0;
      width: 100%;
      height: 92px;
      background: #191919;
      z-index: 3;
      pointer-events: none;
    }

    /* 边界提示效果 */
    .boundary-hint {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 40px;
      height: 40px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
      z-index: 15;
    }

    .boundary-hint.show {
      opacity: 1;
    }

    .boundary-hint.left {
      left: 20px;
    }

    .boundary-hint.right {
      right: 20px;
    }

    .boundary-hint::before {
      content: '';
      width: 12px;
      height: 12px;
      border: 2px solid rgba(255, 255, 255, 0.6);
      border-top: none;
      border-right: none;
    }

    .boundary-hint.left::before {
      transform: rotate(45deg);
    }

    .boundary-hint.right::before {
      transform: rotate(-135deg);
    }

    /* 响应式调整 */
    @media (max-width: 768px) {
      .slide-indicators {
        bottom: 100px;
      }
      
      .indicator {
        width: 6px;
        height: 6px;
      }
      
      .boundary-hint {
        width: 30px;
        height: 30px;
      }
      
      .boundary-hint::before {
        width: 8px;
        height: 8px;
      }
    }
  </style>
</head>
<body>
  <div class="app-frame">
    <!-- 横向滑动背景 -->
    <div class="horizontal-bg-container">
      <div class="bg-slider" id="bgSlider"></div>
      
      <!-- 滑动提示 -->
      <div class="slide-hint" id="slideHint">
        左右滑动查看图片不同部分
      </div>
      
      <!-- 滑动指示器 -->
      <div class="slide-indicators" id="slideIndicators">
        <div class="indicator active" data-index="0"></div>
        <div class="indicator" data-index="1"></div>
        <div class="indicator" data-index="2"></div>
      </div>
    </div>

    <!-- 内容层 -->
    <div class="content-layer">
      <div class="page-title"></div>
      
      <!-- 中心交互按钮 -->
      <a href="#" class="interaction-btn btn-center" title="Center Interaction">
        <img src="../svg/2nd floor button.svg" alt="Center Button"/>
      </a>
      
      <!-- 边界提示 -->
      <div class="boundary-hint left" id="leftHint"></div>
      <div class="boundary-hint right" id="rightHint"></div>
    </div>

    <div class="bottom-mask"></div>
  </div>

  <!-- Footer自动插入点 -->
  <div id="footer-placeholder"></div>

  <script src="../js/footer.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      console.log('Filet-o-Fish page loaded');
      
      const bgSlider = document.getElementById('bgSlider');
      const slideIndicators = document.getElementById('slideIndicators');
      const indicators = slideIndicators.querySelectorAll('.indicator');
      const slideHint = document.getElementById('slideHint');
      const leftHint = document.getElementById('leftHint');
      const rightHint = document.getElementById('rightHint');
      
      let currentPosition = 0; // 当前位置（百分比）
      let isDragging = false;
      let startX = 0;
      let currentX = 0;
      let startPosition = 0; // 开始拖动时的位置
      let maxSlideDistance = 0; // 最大滑动距离

      // 初始化
      function initSlider() {
        // 计算最大滑动距离
        // 图片宽度是容器的3倍，所以可以滑动的距离是200%
        maxSlideDistance = 200;
        
        updateSlider();
        showHint();
      }

      // 更新滑块位置
      function updateSlider() {
        // 限制滑动范围在0到-maxSlideDistance之间
        currentPosition = Math.max(-maxSlideDistance, Math.min(0, currentPosition));
        bgSlider.style.transform = `translateX(${currentPosition}%)`;
        
        // 更新指示器位置（可选，用于显示当前位置）
        updateIndicators();
        
        // 更新边界提示
        updateBoundaryHints();
      }

      // 更新边界提示
      function updateBoundaryHints() {
        // 显示左边界提示（当在右边界时）
        if (currentPosition <= -maxSlideDistance + 5) {
          rightHint.classList.add('show');
        } else {
          rightHint.classList.remove('show');
        }
        
        // 显示右边界提示（当在左边界时）
        if (currentPosition >= -5) {
          leftHint.classList.add('show');
        } else {
          leftHint.classList.remove('show');
        }
      }

      // 更新指示器
      function updateIndicators() {
        const progress = Math.abs(currentPosition) / maxSlideDistance;
        const activeIndex = Math.round(progress * 2); // 0, 1, 2
        
        indicators.forEach((indicator, index) => {
          indicator.classList.toggle('active', index === activeIndex);
        });
      }

      // 显示提示
      function showHint() {
        slideHint.classList.add('show');
        setTimeout(() => {
          slideHint.classList.remove('show');
        }, 3000);
      }

      // 切换到指定位置
      function goToPosition(percentage) {
        currentPosition = -percentage * maxSlideDistance / 100;
        updateSlider();
      }

      // 鼠标事件
      bgSlider.addEventListener('mousedown', function(e) {
        isDragging = true;
        startX = e.clientX;
        currentX = startX;
        startPosition = currentPosition; // 记录开始拖动时的位置
        bgSlider.style.cursor = 'grabbing';
        bgSlider.style.transition = 'none';
      });

      document.addEventListener('mousemove', function(e) {
        if (!isDragging) return;
        
        currentX = e.clientX;
        const diff = currentX - startX;
        const moveDistance = (diff / window.innerWidth) * maxSlideDistance;
        
        // 计算目标位置（基于开始拖动时的位置）
        let targetPosition = startPosition - (diff / window.innerWidth) * maxSlideDistance;
        
        // 添加边界限制和阻力效果
        if (targetPosition > 0) {
          // 向右滑动超出左边界，添加阻力
          targetPosition = targetPosition * 0.3;
        } else if (targetPosition < -maxSlideDistance) {
          // 向左滑动超出右边界，添加阻力
          const overDistance = Math.abs(targetPosition + maxSlideDistance);
          targetPosition = -maxSlideDistance - (overDistance * 0.3);
        }
        
        currentPosition = targetPosition;
        bgSlider.style.transform = `translateX(${currentPosition}%)`;
      });

      document.addEventListener('mouseup', function() {
        if (!isDragging) return;
        
        isDragging = false;
        bgSlider.style.cursor = 'grab';
        bgSlider.style.transition = 'transform 0.3s ease-out';
        
        // 确保最终位置在有效范围内
        currentPosition = Math.max(-maxSlideDistance, Math.min(0, currentPosition));
        updateSlider();
      });

      // 触摸事件（移动端）
      bgSlider.addEventListener('touchstart', function(e) {
        isDragging = true;
        startX = e.touches[0].clientX;
        currentX = startX;
        startPosition = currentPosition; // 记录开始拖动时的位置
        bgSlider.style.transition = 'none';
      });

      document.addEventListener('touchmove', function(e) {
        if (!isDragging) return;
        
        currentX = e.touches[0].clientX;
        const diff = currentX - startX;
        const moveDistance = (diff / window.innerWidth) * maxSlideDistance;
        
        // 计算目标位置（基于开始拖动时的位置）
        let targetPosition = startPosition - (diff / window.innerWidth) * maxSlideDistance;
        
        // 添加边界限制和阻力效果
        if (targetPosition > 0) {
          // 向右滑动超出左边界，添加阻力
          targetPosition = targetPosition * 0.3;
        } else if (targetPosition < -maxSlideDistance) {
          // 向左滑动超出右边界，添加阻力
          const overDistance = Math.abs(targetPosition + maxSlideDistance);
          targetPosition = -maxSlideDistance - (overDistance * 0.3);
        }
        
        currentPosition = targetPosition;
        bgSlider.style.transform = `translateX(${currentPosition}%)`;
      });

      document.addEventListener('touchend', function() {
        if (!isDragging) return;
        
        isDragging = false;
        bgSlider.style.transition = 'transform 0.3s ease-out';
        
        // 确保最终位置在有效范围内
        currentPosition = Math.max(-maxSlideDistance, Math.min(0, currentPosition));
        updateSlider();
      });

      // 指示器点击事件
      indicators.forEach((indicator, index) => {
        indicator.addEventListener('click', function() {
          const percentage = (index / 2) * 100; // 0%, 50%, 100%
          goToPosition(percentage);
        });
      });

      // 键盘事件
      document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowLeft') {
          currentPosition = Math.max(-maxSlideDistance, currentPosition - 20);
          updateSlider();
        } else if (e.key === 'ArrowRight') {
          currentPosition = Math.min(0, currentPosition + 20);
          updateSlider();
        }
      });

      // 中心按钮点击事件
      const centerBtn = document.querySelector('.btn-center');
      if (centerBtn) {
        centerBtn.addEventListener('click', function(e) {
          e.preventDefault();
          console.log('Center button clicked');
          // 这里可以添加您的交互逻辑
          alert('中心按钮被点击了！');
        });
      }

      // 初始化
      initSlider();

      // 检查footer是否加载
      setTimeout(() => {
        const footer = document.querySelector('.bottom-nav');
        if (footer) {
          console.log('Footer loaded successfully');
        } else {
          console.log('Footer not found');
        }
      }, 1000);
    });
  </script>
</body>
</html>
